{% extends 'layouts/base.html.twig' %}

{% block body %}
    <div class="col-lg-12" id="questionnaire" data-id="{{ questionnaire.id }}">
        <div class="bs-docs-section">
            <div class="row">
                <div class="col-md-12">
                    <h1>Editing "{{ questionnaire.name }}"</h1>
                    <hr>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <h3>Questionnaire details</h3>
                </div>
                <div class="col-md-12">
                    <div class="well">
                        <div class="row details">
                            <div class="col-md-4">
                                <label>Questionnaire name</label>
                                <input type="text" value="{{ questionnaire.name }}" placeholder="Enter you questionnaire name" class="form-control name">
                            </div>
                            <div class="col-md-4">
                                <label>Valid until</label>
                                <input type="text" value="{{ questionnaire.expires|date }}" placeholder="When your questionnaire expires" class="form-control expires">
                            </div>
                            <div class="col-md-4">
                                <label>Actions</label>
                                <div>
                                    <button id="save-questionnaire" class="btn btn-success">Save changes</button>
                                    <button id="publish-questionnaire" class="btn btn-primary">Publish</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div id="questions">
                        {% for question in questionnaire.questions %}
                            <h3>Question {{ loop.index0 + 1 }}</h3>
                            <div class="well question" data-id="{{ question.id }}">
                                <div class="row">
                                    <div class="col-md-9">
                                        <div class="row">
                                            <div class="col-md-5">
                                                <div class="row">
                                                    <div class="col-md-12 answers">
                                                        <h3>Answers</h3>
                                                        {% for answer in question.answers %}
                                                            <div class="input-group answer" data-id="{{ answer.id }}">
                                                                <input type="text" value="{{ answer.content }}" data-id="{{ answer.id }}" placeholder="Answer {{ loop.index0 + 1 }}" class="form-control">
                                                                <span class="input-group-btn">
                                                                    <button type="button" class="btn btn-success add-answer">
                                                                        <span class="glyphicon glyphicon-plus"></span>
                                                                    </button>
                                                                    {% if question.answers|length > 1 %}
                                                                        <button type="button" class="btn btn-danger remove-answer">
                                                                            <span class="glyphicon glyphicon-remove"></span>
                                                                        </button>
                                                                    {% endif %}
                                                                </span>
                                                            </div>
                                                        {% endfor %}
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-7">
                                                <h3>Question text</h3>
                                                <textarea rows="5" class="form-control description" placeholder="Enter your question description">{{ question.content }}</textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="row actions">
                                            <div class="col-md-12">
                                                <h3>Options</h3>
                                            </div>
                                            <div class="col-md-12 action-row">
                                                <select name="type" class="form-control type">
                                                    <option {{ question.type == 'MULTPLE' ? 'selected="selected"' : '' }} value="MULTIPLE">Multiple selection</option>
                                                    <option {{ question.type == 'SINGLE' ? 'selected="selected"' : '' }} value="SINGLE">Single selection</option>
                                                </select>
                                            </div>
                                            <div class="col-md-12 action-row">
                                                <button class="btn btn-success btn-block add-question">Add question</button>
                                            </div>
                                            {% if questionnaire.questions|length > 1 %}
                                                <div class="col-md-12 action-row">
                                                    <button class="btn btn-danger btn-block remove-question">Remove question</button>
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascript %}
    <script type="application/javascript" src="{{ asset('bundles/site/js/questionnaires/creation.js') }}"></script>
{% endblock %}